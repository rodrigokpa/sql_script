CREATE PROCEDURE [dbo].[sp_FindDependencies]
         @OBJECTNAME SYSNAME,
         @OBJECTTYPE VARCHAR(5) = NULL
 AS
 BEGIN

	SELECT	OBJECT_NAME(ID) OBJECT_NAME
	FROM	SYSCOMMENTS
	WHERE	TEXT LIKE '%' + @OBJECTNAME + '%'

     /*DECLARE @OBJECTID AS BIGINT    

         SELECT TOP(1) @OBJECTID = OBJECT_ID
         FROM SYS.OBJECTS
         WHERE NAME = @OBJECTNAME
         AND TYPE = ISNULL(@OBJECTTYPE, TYPE)    

     SET NOCOUNT ON ;    

       WITH DEPENDENTOBJECTCTE (DEPENDENTOBJECTID, DEPENDENTOBJECTNAME, REFERENCEDOBJECTNAME, REFERENCEDOBJECTID)
         AS
         (
         SELECT DISTINCT
                SD.OBJECT_ID,
                OBJECT_NAME(SD.OBJECT_ID),
                REFERENCEDOBJECT = OBJECT_NAME(SD.REFERENCED_MAJOR_ID),
                REFERENCEDOBJECTID = SD.REFERENCED_MAJOR_ID
         FROM    
                SYS.SQL_DEPENDENCIES SD
                JOIN SYS.OBJECTS SO ON SD.REFERENCED_MAJOR_ID = SO.OBJECT_ID
         WHERE   
                SD.REFERENCED_MAJOR_ID = @OBJECTID
         UNION ALL
         SELECT
                SD.OBJECT_ID,
                OBJECT_NAME(SD.OBJECT_ID),
                OBJECT_NAME(REFERENCED_MAJOR_ID),
                OBJECT_ID
         FROM    
                SYS.SQL_DEPENDENCIES SD
				JOIN DEPENDENTOBJECTCTE DO ON SD.REFERENCED_MAJOR_ID = DO.DEPENDENTOBJECTID       
         WHERE
                SD.REFERENCED_MAJOR_ID <> SD.OBJECT_ID     
         )
         SELECT DISTINCT
                DEPENDENTOBJECTNAME,
				SO.TYPE_DESC
         FROM   
                DEPENDENTOBJECTCTE C
				JOIN SYS.OBJECTS SO ON C.DEPENDENTOBJECTID = SO.OBJECT_ID*/
 END

