CREATE FUNCTION PROPERCASE(@STRING VARCHAR(MAX)) RETURNS VARCHAR(MAX) AS
BEGIN

SET @STRING = LOWER(@STRING)

IF LEN(@STRING) > 0
BEGIN

DECLARE @I INT
SET @I = ASCII('a')

WHILE @I <= ASCII('z')
BEGIN

SET @STRING = REPLACE(@STRING, ' ' + CHAR(@I), ' ' + CHAR(@I-32))
SET @I = @I + 1
END

SET @STRING = CHAR(ASCII(LEFT(@STRING, 1))-32) + RIGHT(@STRING, LEN(@STRING)-1)
END

RETURN @STRING

END
