CREATE PROCEDURE SPR_DBM_RENOMEIA_TAB_E_PROC  
(
	@TABELA VARCHAR(100),
	@SCHEMA VARCHAR(20) = 'DBO.',  -- OPCIONAL
	@PREFIXO VARCHAR(50) = 'APAGAR_' --OPCIONAL
)

AS
SET NOCOUNT ON

IF OBJECT_ID(@TABELA) IS NOT NULL
BEGIN
	DECLARE @SQL NVARCHAR(MAX)

	SET @SQL = 



	'EXEC SP_RENAME '+CHAR(39) +@SCHEMA+@TABELA+CHAR(39)+' , '+CHAR(39)+@PREFIXO+@TABELA+CHAR(39)

	EXEC SP_EXECUTESQL @SQL

	PRINT 'RENOMEADO PARA:' +@PREFIXO+@TABELA
END
ELSE
PRINT 'NÃO EXISTE O OBJETO: '+@TABELA+ ' NO BANCO:'+ DB_NAME() 


SET NOCOUNT OFF

/*
EXEMPLO DE CHAMADA DEFAULT -- SÓ PASSA O NOME DA TABELA
SPR_DBM_RENOMEIA_TABELA  TESTE1
RES: APAGAR_TESTE1



EXEMPLO DE CHAMADA COM PARAMETROS

SPR_DBM_RENOMEIA_TABELA 
	@TABELA = 'TESTE' ,
	@SCHEMA  = 'CONTROLE',  -- OPCIONAL
	@PREFIXO  = 'XXXX_' --OPCIONAL

RES: XXXX_TESTE


*/
